{"version":3,"sources":["index.ios.tsx"],"names":["getPreferredUnit","type","unit","getPreferredUnits","ensureUnit","providedUnit","Native","deserializeSample","sample","startDate","Date","endDate","deserializeWorkout","deserializCategorySample","serializeDate","date","toISOString","prepareOptions","options","limit","Infinity","ascending","from","to","queryQuantitySamples","identifier","opts","quantitySamples","map","subscribeToChanges","callback","subscription","EventEmitter","addListener","typeIdentifier","queryId","subscribeToObserverQuery","catch","error","remove","Promise","reject","unsubscribeQuery","getMostRecentQuantitySample","samples","useMostRecentWorkout","workout","setWorkout","cancelSubscription","init","energyUnit","distanceUnit","getPreferredUnitsTyped","getMostRecentWorkout","then","getMostRecentCategorySample","queryCategorySamples","useMostRecentCategorySample","category","setCategory","updater","useSubscribeToChanges","onChange","useMostRecentQuantitySample","lastSample","setLastSample","actualUnit","value","saveQuantitySample","start","end","metadata","queryStatisticsForQuantity","toDate","mostRecentQuantityDateInterval","rawResponse","response","requestAuthorization","read","write","readPermissions","reduce","obj","cur","writePermissions","getDateOfBirth","dateOfBirth","getRequestStatusForAuthorization","results","units","HKQuantityTypeIdentifier","distanceWalkingRunning","activeEnergyBurned","HKUnit","Kilocalories","Meters","queryWorkouts","workouts","queryWorkoutSamples","saveCategorySample","identifiers","i","buildUnitWithPrefix","prefix","deserializeCorrelation","s","objects","o","quantity","undefined","ensureMetadata","queryCorrelationSamples","correlations","saveCorrelationSample","saveWorkoutSample","quantities","_start","Healthkit","authorizationStatusFor","isHealthDataAvailable","disableAllBackgroundDelivery","disableBackgroundDelivery","enableBackgroundDelivery","getBiologicalSex","getFitzpatrickSkinType","getWheelchairUse","getBloodType"],"mappings":";;;;;;;;AAAA;;AACA;;AA0kBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AADA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;AAjiBA,MAAMA,gBAAoC,GAAG,MAAOC,IAAP,IAAgB;AAC3D,QAAM,CAACC,IAAD,IAAS,MAAMC,iBAAiB,CAAC,CAACF,IAAD,CAAD,CAAtC;AACA,SAAOC,IAAP;AACD,CAHD;;AAKA,MAAME,UAAU,GAAG,OACjBH,IADiB,EAEjBI,YAFiB,KAGd;AACH,MAAIA,YAAJ,EAAkB;AAChB,WAAOA,YAAP;AACD;;AACD,QAAMH,IAAI,GAAG,MAAMI,qBAAOH,iBAAP,CAAyB,CAACF,IAAD,CAAzB,CAAnB;AACA,SAAOC,IAAI,CAACD,IAAD,CAAX;AACD,CATD;;AAWA,SAASM,iBAAT,CAIEC,MAJF,EAKwC;AACtC,SAAO,EACL,GAAGA,MADE;AAELC,IAAAA,SAAS,EAAE,IAAIC,IAAJ,CAASF,MAAM,CAACC,SAAhB,CAFN;AAGLE,IAAAA,OAAO,EAAE,IAAID,IAAJ,CAASF,MAAM,CAACG,OAAhB;AAHJ,GAAP;AAKD;;AAED,SAASC,kBAAT,CACEJ,MADF,EAEiC;AAC/B,SAAO,EACL,GAAGA,MADE;AAELC,IAAAA,SAAS,EAAE,IAAIC,IAAJ,CAASF,MAAM,CAACC,SAAhB,CAFN;AAGLE,IAAAA,OAAO,EAAE,IAAID,IAAJ,CAASF,MAAM,CAACG,OAAhB;AAHJ,GAAP;AAKD;;AAED,MAAME,wBAAwB,GAC5BL,MAD+B,IAEP;AACxB,SAAO,EACL,GAAGA,MADE;AAELC,IAAAA,SAAS,EAAE,IAAIC,IAAJ,CAASF,MAAM,CAACC,SAAhB,CAFN;AAGLE,IAAAA,OAAO,EAAE,IAAID,IAAJ,CAASF,MAAM,CAACG,OAAhB;AAHJ,GAAP;AAKD,CARD;;AAUA,MAAMG,aAAa,GAAIC,IAAD,IAAgC;AACpD,SAAOA,IAAI,GAAGA,IAAI,CAACC,WAAL,EAAH,GAAwB,IAAIN,IAAJ,CAAS,CAAT,EAAYM,WAAZ,EAAnC;AACD,CAFD;;AAIA,MAAMC,cAAc,GAAIC,OAAD,IAAkC;AAAA;;AACvD,QAAMC,KAAK,GACT,CAACD,OAAO,CAACC,KAAT,IAAkBD,OAAO,CAACC,KAAR,KAAkBC,QAApC,GAA+C,CAA/C,GAAmDF,OAAO,CAACC,KAD7D;AAEA,QAAME,SAAS,yBAAGH,OAAO,CAACG,SAAX,mEAAwBF,KAAK,KAAK,CAAjD;AACA,QAAMG,IAAI,GAAGR,aAAa,CAACI,OAAO,CAACI,IAAT,CAA1B;AACA,QAAMC,EAAE,GAAGT,aAAa,CAACI,OAAO,CAACK,EAAT,CAAxB;AACA,SAAO;AAAEJ,IAAAA,KAAF;AAASE,IAAAA,SAAT;AAAoBC,IAAAA,IAApB;AAA0BC,IAAAA;AAA1B,GAAP;AACD,CAPD;;AASA,MAAMC,oBAA4C,GAAG,OACnDC,UADmD,EAEnDP,OAFmD,KAGhD;AACH,QAAMhB,IAAI,GAAG,MAAME,UAAU,CAACqB,UAAD,EAAaP,OAAO,CAAChB,IAArB,CAA7B;AACA,QAAMwB,IAAI,GAAGT,cAAc,CAACC,OAAD,CAA3B;AAEA,QAAMS,eAAe,GAAG,MAAMrB,qBAAOkB,oBAAP,CAC5BC,UAD4B,EAE5BvB,IAF4B,EAG5BwB,IAAI,CAACJ,IAHuB,EAI5BI,IAAI,CAACH,EAJuB,EAK5BG,IAAI,CAACP,KALuB,EAM5BO,IAAI,CAACL,SANuB,CAA9B;AASA,SAAOM,eAAe,CAACC,GAAhB,CAAoBrB,iBAApB,CAAP;AACD,CAjBD;;AAmBA,MAAMsB,kBAAwC,GAAG,OAC/CJ,UAD+C,EAE/CK,QAF+C,KAG5C;AACH,QAAMC,YAAY,GAAGC,0BAAaC,WAAb,CACnB,UADmB,EAEnB,CAAC;AAAEC,IAAAA;AAAF,GAAD,KAAwB;AACtB,QAAIA,cAAc,KAAKT,UAAvB,EAAmC;AACjCK,MAAAA,QAAQ;AACT;AACF,GANkB,CAArB;;AASA,QAAMK,OAAO,GAAG,MAAM7B,qBAAO8B,wBAAP,CAAgCX,UAAhC,EAA4CY,KAA5C,CACnBC,KAAD,IAAW;AACTP,IAAAA,YAAY,CAACQ,MAAb;AACA,WAAOC,OAAO,CAACC,MAAR,CAAeH,KAAf,CAAP;AACD,GAJmB,CAAtB;AAOA,SAAO,MAAM;AACXP,IAAAA,YAAY,CAACQ,MAAb;AACA,WAAOjC,qBAAOoC,gBAAP,CAAwBP,OAAxB,CAAP;AACD,GAHD;AAID,CAxBD;;AA0BA,MAAMQ,2BAA0D,GAAG,OACjElB,UADiE,EAEjEvB,IAFiE,KAG9D;AACH,QAAM0C,OAAO,GAAG,MAAMpB,oBAAoB,CAACC,UAAD,EAAa;AACrDN,IAAAA,KAAK,EAAE,CAD8C;AAErDjB,IAAAA,IAAI,EAAEA;AAF+C,GAAb,CAA1C;AAIA,SAAO0C,OAAO,CAAC,CAAD,CAAd;AACD,CATD;;AAWA,SAASC,oBAAT,CAGE3B,OAHF,EAGgE;AAC9D,QAAM,CAAC4B,OAAD,EAAUC,UAAV,IAAwB,qBAC5B,IAD4B,CAA9B;AAGA,wBAAU,MAAM;AACd,QAAIC,kBAAJ;;AAEA,UAAMC,IAAI,GAAG,YAAY;AACvB,YAAM;AAAEC,QAAAA,UAAF;AAAcC,QAAAA;AAAd,UAA+B,MAAMC,sBAAsB,CAC/DlC,OAD+D,CAAjE;AAIA8B,MAAAA,kBAAkB,GAAG,MAAMnB,kBAAkB,CAC3C,yBAD2C,EAE3C,MAAM;AACJwB,QAAAA,oBAAoB,CAAC;AAAEH,UAAAA,UAAF;AAAcC,UAAAA;AAAd,SAAD,CAApB,CAAmDG,IAAnD,CAAwDP,UAAxD;AACD,OAJ0C,CAA7C;AAMD,KAXD;;AAYAE,IAAAA,IAAI;AACJ,WAAO,MAAM;AACXD,MAAAA,kBAAkB,IAAIA,kBAAkB,EAAxC;AACD,KAFD;AAGD,GAnBD,EAmBG,CAAC9B,OAAD,CAnBH;AAoBA,SAAO4B,OAAP;AACD;;AAED,MAAMS,2BAA0D,GAAG,MACjE9B,UADiE,IAE9D;AACH,QAAMmB,OAAO,GAAG,MAAMY,oBAAoB,CAAC/B,UAAD,EAAa;AACrDN,IAAAA,KAAK,EAAE,CAD8C;AAErDE,IAAAA,SAAS,EAAE;AAF0C,GAAb,CAA1C;AAKA,SAAOuB,OAAO,CAAC,CAAD,CAAd;AACD,CATD;;AAWA,SAASa,2BAAT,CAEEhC,UAFF,EAEyB;AACvB,QAAM,CAACiC,QAAD,EAAWC,WAAX,IAA0B,qBAC9B,IAD8B,CAAhC;AAGA,QAAMC,OAAO,GAAG,wBAAY,MAAM;AAChCL,IAAAA,2BAA2B,CAAC9B,UAAD,CAA3B,CAAwC6B,IAAxC,CAA6CK,WAA7C;AACD,GAFe,EAEb,CAAClC,UAAD,CAFa,CAAhB;AAIAoC,EAAAA,qBAAqB,CAACpC,UAAD,EAAamC,OAAb,CAArB;AAEA,SAAOF,QAAP;AACD;;AAED,SAASG,qBAAT,CACEpC,UADF,EAEEqC,QAFF,EAGQ;AACN,wBAAU,MAAM;AACd,QAAId,kBAAJ;;AAEA,UAAMC,IAAI,GAAG,YAAY;AACvBD,MAAAA,kBAAkB,GAAG,MAAMnB,kBAAkB,CAACJ,UAAD,EAAaqC,QAAb,CAA7C;AACD,KAFD;;AAGAb,IAAAA,IAAI;AAEJ,WAAO,MAAM;AACXD,MAAAA,kBAAkB,IAAIA,kBAAkB,EAAxC;AACD,KAFD;AAGD,GAXD,EAWG,CAACvB,UAAD,EAAaqC,QAAb,CAXH;AAYD;;AAED,SAASC,2BAAT,CAGEtC,UAHF,EAG2BvB,IAH3B,EAGyC;AACvC,QAAM,CAAC8D,UAAD,EAAaC,aAAb,IAA8B,qBAG1B,IAH0B,CAApC;AAKA,wBAAU,MAAM;AACd,QAAIjB,kBAAJ;;AAEA,UAAMC,IAAI,GAAG,YAAY;AACvB,YAAMiB,UAAU,GAAG,MAAM9D,UAAU,CAACqB,UAAD,EAAavB,IAAb,CAAnC;AAEA8C,MAAAA,kBAAkB,GAAG,MAAMnB,kBAAkB,CAACJ,UAAD,EAAa,MAAM;AAC9DkB,QAAAA,2BAA2B,CAAClB,UAAD,EAAayC,UAAb,CAA3B,CAAoDZ,IAApD,CAA0Da,KAAD,IAAW;AAClEF,UAAAA,aAAa,CAACE,KAAD,CAAb;AACD,SAFD;AAGD,OAJ4C,CAA7C;AAKD,KARD;;AASAlB,IAAAA,IAAI;AAEJ,WAAO,MAAM;AACXD,MAAAA,kBAAkB,IAAIA,kBAAkB,EAAxC;AACD,KAFD;AAGD,GAjBD,EAiBG,CAACvB,UAAD,EAAavB,IAAb,CAjBH;AAmBA,SAAO8D,UAAP;AACD;;AAED,MAAMI,kBAAwC,GAAG,CAC/C3C,UAD+C,EAE/CvB,IAF+C,EAG/CiE,KAH+C,EAI/CjD,OAJ+C,KAK5C;AACH,QAAMmD,KAAK,GAAG,CAAAnD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEmD,KAAT,MAAkBnD,OAAlB,aAAkBA,OAAlB,uBAAkBA,OAAO,CAAEoD,GAA3B,KAAkC,IAAI5D,IAAJ,EAAhD;AACA,QAAM4D,GAAG,GAAG,CAAApD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEoD,GAAT,MAAgBpD,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEmD,KAAzB,KAAkC,IAAI3D,IAAJ,EAA9C;AACA,QAAM6D,QAAQ,GAAG,CAAArD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEqD,QAAT,KAAqB,EAAtC;AAEA,SAAOjE,qBAAO8D,kBAAP,CACL3C,UADK,EAELvB,IAFK,EAGLiE,KAHK,EAILE,KAAK,CAACrD,WAAN,EAJK,EAKLsD,GAAG,CAACtD,WAAJ,EALK,EAMLuD,QANK,CAAP;AAQD,CAlBD;;AAoBA,MAAMC,0BAAwD,GAAG,OAC/D/C,UAD+D,EAE/DP,OAF+D,EAG/DI,IAH+D,EAI/DC,EAJ+D,EAK/DrB,IAL+D,KAM5D;AACH,QAAMgE,UAAU,GAAG,MAAM9D,UAAU,CAACqB,UAAD,EAAavB,IAAb,CAAnC;AACA,QAAMuE,MAAM,GAAGlD,EAAE,IAAI,IAAIb,IAAJ,EAArB;AACA,QAAM;AACJgE,IAAAA,8BADI;AAEJ,OAAGC;AAFC,MAGF,MAAMrE,qBAAOkE,0BAAP,CACR/C,UADQ,EAERyC,UAFQ,EAGR5C,IAAI,CAACN,WAAL,EAHQ,EAIRyD,MAAM,CAACzD,WAAP,EAJQ,EAKRE,OALQ,CAHV;AAWA,QAAM0D,QAAQ,GAAG,EACf,GAAGD,WADY;AAEf,QAAID,8BAA8B,GAC9B;AACEA,MAAAA,8BAA8B,EAAE;AAC9BpD,QAAAA,IAAI,EAAE,IAAIZ,IAAJ,CAASgE,8BAA8B,CAACpD,IAAxC,CADwB;AAE9BC,QAAAA,EAAE,EAAE,IAAIb,IAAJ,CAASgE,8BAA8B,CAACnD,EAAxC;AAF0B;AADlC,KAD8B,GAO9B,EAPJ;AAFe,GAAjB;AAYA,SAAOqD,QAAP;AACD,CAjCD;;AAmCA,MAAMC,oBAAoB,GAAG,CAC3BC,IAD2B,EAE3BC,KAA+B,GAAG,EAFP,KAGN;AACrB,QAAMC,eAAe,GAAGF,IAAI,CAACG,MAAL,CAAY,CAACC,GAAD,EAAMC,GAAN,KAAc;AAChD,WAAO,EAAE,GAAGD,GAAL;AAAU,OAACC,GAAD,GAAO;AAAjB,KAAP;AACD,GAFuB,EAErB,EAFqB,CAAxB;AAIA,QAAMC,gBAAgB,GAAGL,KAAK,CAACE,MAAN,CAAa,CAACC,GAAD,EAAMC,GAAN,KAAc;AAClD,WAAO,EAAE,GAAGD,GAAL;AAAU,OAACC,GAAD,GAAO;AAAjB,KAAP;AACD,GAFwB,EAEtB,EAFsB,CAAzB;AAIA,SAAO7E,qBAAOuE,oBAAP,CAA4BO,gBAA5B,EAA8CJ,eAA9C,CAAP;AACD,CAbD;;AAeA,MAAMK,cAAc,GAAG,YAAY;AACjC,QAAMC,WAAW,GAAG,MAAMhF,qBAAO+E,cAAP,EAA1B;AACA,SAAO,IAAI3E,IAAJ,CAAS4E,WAAT,CAAP;AACD,CAHD;;AAKA,MAAMC,gCAAgC,GAAG,CACvCT,IADuC,EAEvCC,KAA+B,GAAG,EAFK,KAGpC;AACH,QAAMC,eAAe,GAAGF,IAAI,CAACG,MAAL,CAAY,CAACC,GAAD,EAAMC,GAAN,KAAc;AAChD,WAAO,EAAE,GAAGD,GAAL;AAAU,OAACC,GAAD,GAAO;AAAjB,KAAP;AACD,GAFuB,EAErB,EAFqB,CAAxB;AAIA,QAAMC,gBAAgB,GAAGL,KAAK,CAACE,MAAN,CAAa,CAACC,GAAD,EAAMC,GAAN,KAAc;AAClD,WAAO,EAAE,GAAGD,GAAL;AAAU,OAACC,GAAD,GAAO;AAAjB,KAAP;AACD,GAFwB,EAEtB,EAFsB,CAAzB;AAIA,SAAO7E,qBAAOiF,gCAAP,CACLH,gBADK,EAELJ,eAFK,CAAP;AAID,CAhBD;;AAkBA,MAAMxB,oBAA4C,GAAG,OACnD/B,UADmD,EAEnDP,OAFmD,KAGhD;AACH,QAAMQ,IAAI,GAAGT,cAAc,CAACC,OAAD,CAA3B;AACA,QAAMsE,OAAO,GAAG,MAAMlF,qBAAOkD,oBAAP,CACpB/B,UADoB,EAEpBC,IAAI,CAACJ,IAFe,EAGpBI,IAAI,CAACH,EAHe,EAIpBG,IAAI,CAACP,KAJe,EAKpBO,IAAI,CAACL,SALe,CAAtB;AAQA,SAAOmE,OAAO,CAAC5D,GAAR,CAAYf,wBAAZ,CAAP;AACD,CAdD;;AAgBA,eAAeuC,sBAAf,CAGElC,OAHF,EAGgE;AAC9D,MAAIgC,UAAU,GAAGhC,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAEgC,UAA1B;AACA,MAAIC,YAAY,GAAGjC,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAEiC,YAA5B;;AACA,MAAI,CAACD,UAAD,IAAe,CAACC,YAApB,EAAkC;AAChC,UAAMsC,KAAK,GAAG,MAAMnF,qBAAOH,iBAAP,CAAyB,CAC3CuF,sCAAyBC,sBADkB,EAE3CD,sCAAyBE,kBAFkB,CAAzB,CAApB;;AAIA,QAAI,CAAC1C,UAAL,EAAiB;AACfA,MAAAA,UAAU,GAAGuC,KAAK,CAACC,sCAAyBC,sBAA1B,CAAlB;AAGD;;AACD,QAAI,CAACxC,YAAL,EAAmB;AACjBA,MAAAA,YAAY,GAAGsC,KAAK,CAACC,sCAAyBE,kBAA1B,CAApB;AAGD;AACF;;AACD,MAAI,CAAC1C,UAAL,EAAiB;AACfA,IAAAA,UAAU,GAAG2C,oBAAOC,YAApB;AACD;;AACD,MAAI,CAAC3C,YAAL,EAAmB;AACjBA,IAAAA,YAAY,GAAG0C,oBAAOE,MAAtB;AACD;;AACD,SAAO;AAAE7C,IAAAA,UAAF;AAAcC,IAAAA;AAAd,GAAP;AACD;;AAED,MAAM6C,aAA8B,GAAG,MAAO9E,OAAP,IAAmB;AACxD,QAAM;AAAEgC,IAAAA,UAAF;AAAcC,IAAAA;AAAd,MAA+B,MAAMC,sBAAsB,CAAClC,OAAD,CAAjE;AACA,QAAMQ,IAAI,GAAGT,cAAc,CAACC,OAAD,CAA3B;AAEA,QAAM+E,QAAQ,GAAG,MAAM3F,qBAAO4F,mBAAP,CACrBhD,UADqB,EAErBC,YAFqB,EAGrBzB,IAAI,CAACJ,IAHgB,EAIrBI,IAAI,CAACH,EAJgB,EAKrBG,IAAI,CAACP,KALgB,EAMrBO,IAAI,CAACL,SANgB,CAAvB;AASA,SAAO4E,QAAQ,CAACrE,GAAT,CAAahB,kBAAb,CAAP;AACD,CAdD;;AAgBA,MAAMyC,oBAA4C,GAAG,MAAOnC,OAAP,IAAmB;AACtE,QAAM+E,QAAQ,GAAG,MAAMD,aAAa,CAAC;AACnC7E,IAAAA,KAAK,EAAE,CAD4B;AAEnCE,IAAAA,SAAS,EAAE,KAFwB;AAGnC6B,IAAAA,UAAU,EAAEhC,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEgC,UAHc;AAInCC,IAAAA,YAAY,EAAEjC,OAAF,aAAEA,OAAF,uBAAEA,OAAO,CAAEiC;AAJY,GAAD,CAApC;AAOA,SAAO8C,QAAQ,CAAC,CAAD,CAAf;AACD,CATD;;AAWA,SAASE,kBAAT,CACE1E,UADF,EAEE0C,KAFF,EAGEjD,OAHF,EAQE;AACA,QAAMmD,KAAK,GAAG,CAAAnD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEmD,KAAT,MAAkBnD,OAAlB,aAAkBA,OAAlB,uBAAkBA,OAAO,CAAEoD,GAA3B,KAAkC,IAAI5D,IAAJ,EAAhD;AACA,QAAM4D,GAAG,GAAG,CAAApD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEoD,GAAT,MAAgBpD,OAAhB,aAAgBA,OAAhB,uBAAgBA,OAAO,CAAEmD,KAAzB,KAAkC,IAAI3D,IAAJ,EAA9C;AACA,QAAM6D,QAAQ,GAAG,CAAArD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEqD,QAAT,KAAqB,EAAtC;AAEA,SAAOjE,qBAAO6F,kBAAP,CACL1E,UADK,EAEL0C,KAFK,EAGLE,KAAK,CAACrD,WAAN,EAHK,EAILsD,GAAG,CAACtD,WAAJ,EAJK,EAKLuD,QAAQ,IAAI,EALP,CAAP;AAOD;;AAED,MAAMpE,iBAAsC,GAAG,MAAOiG,WAAP,IAAuB;AACpE,QAAMX,KAAK,GAAG,MAAMnF,qBAAOH,iBAAP,CAAyBiG,WAAzB,CAApB;AACA,SAAOA,WAAW,CAACxE,GAAZ,CAAiByE,CAAD,IAAOZ,KAAK,CAACY,CAAD,CAA5B,CAAP;AACD,CAHD;;AAKA,MAAMC,mBAAmB,GAAG,CAACC,MAAD,EAAyBrG,IAAzB,KAA4C;AACtE,SAAQ,GAAEqG,MAAO,GAAErG,IAAK,EAAxB;AACD,CAFD;;AAIA,SAASsG,sBAAT,CAEEC,CAFF,EAEgE;AAC9D,SAAO,EACL,GAAGA,CADE;AAELC,IAAAA,OAAO,EAAED,CAAC,CAACC,OAAF,CAAU9E,GAAV,CAAe+E,CAAD,IAAO;AAC5B;AACA,UAAIA,CAAC,CAACC,QAAF,KAAeC,SAAnB,EAA8B;AAC5B,eAAOtG,iBAAiB,CAACoG,CAAD,CAAxB;AACD;;AAED,aAAO9F,wBAAwB,CAAC8F,CAAD,CAA/B;AACD,KAPQ,CAFJ;AAULhG,IAAAA,OAAO,EAAE,IAAID,IAAJ,CAAS+F,CAAC,CAAC9F,OAAX,CAVJ;AAWLF,IAAAA,SAAS,EAAE,IAAIC,IAAJ,CAAS+F,CAAC,CAAChG,SAAX;AAXN,GAAP;AAaD;;AAED,SAASqG,cAAT,CAAmCvC,QAAnC,EAAyD;AACvD,SAAOA,QAAQ,IAAK,EAApB;AACD;;AAED,MAAMwC,uBAAkD,GAAG,OACzD7E,cADyD,EAEzDhB,OAFyD,KAGtD;AACH,QAAMQ,IAAI,GAAGT,cAAc,CAACC,OAAD,CAA3B;AACA,QAAM8F,YAAY,GAAG,MAAM1G,qBAAOyG,uBAAP,CACzB7E,cADyB,EAEzBR,IAAI,CAACJ,IAFoB,EAGzBI,IAAI,CAACH,EAHoB,CAA3B;AAMA,SAAOyF,YAAY,CAACpF,GAAb,CAAiB4E,sBAAjB,CAAP;AACD,CAZD;;AAcA,MAAMS,qBAA8C,GAAG,OACrD/E,cADqD,EAErDU,OAFqD,EAGrD1B,OAHqD,KAIlD;AACH,QAAMmD,KAAK,GAAG,CAAC,CAAAnD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEmD,KAAT,KAAkB,IAAI3D,IAAJ,EAAnB,EAA+BM,WAA/B,EAAd;AACA,QAAMsD,GAAG,GAAG,CAAC,CAAApD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEoD,GAAT,KAAgB,IAAI5D,IAAJ,EAAjB,EAA6BM,WAA7B,EAAZ;AAEA,SAAOV,qBAAO2G,qBAAP,CACL/E,cADK,EAELU,OAFK,EAGLyB,KAHK,EAILC,GAJK,EAKLwC,cAAc,CAAC5F,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEqD,QAAV,CALT,CAAP;AAOD,CAfD;;AAiBA,MAAM2C,iBAAsC,GAAG,CAC7ChF,cAD6C,EAE7CiF,UAF6C,EAG7CC,MAH6C,EAI7ClG,OAJ6C,KAK1C;AACH,QAAMmD,KAAK,GAAG+C,MAAM,CAACpG,WAAP,EAAd;;AACA,QAAMsD,GAAG,GAAG,CAAC,CAAApD,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAEoD,GAAT,KAAgB,IAAI5D,IAAJ,EAAjB,EAA6BM,WAA7B,EAAZ;AAEA,SAAOV,qBAAO4G,iBAAP,CACLhF,cADK,EAELiF,UAFK,EAGL9C,KAHK,EAILC,GAJK,EAKLwC,cAAc,CAAC5F,OAAD,aAACA,OAAD,uBAACA,OAAO,CAAEqD,QAAV,CALT,CAAP;AAOD,CAhBD;;AAkBA,MAAM8C,SAA+B,GAAG;AACtCC,EAAAA,sBAAsB,EAAEhH,qBAAOgH,sBADO;AAGtCC,EAAAA,qBAAqB,EAAEjH,qBAAOiH,qBAHQ;AAKtCjB,EAAAA,mBALsC;AAOtCkB,EAAAA,4BAA4B,EAAElH,qBAAOkH,4BAPC;AAQtCC,EAAAA,yBAAyB,EAAEnH,qBAAOmH,yBARI;AAStCC,EAAAA,wBAAwB,EAAEpH,qBAAOoH,wBATK;AAWtC;AACAC,EAAAA,gBAAgB,EAAErH,qBAAOqH,gBAZa;AAatCC,EAAAA,sBAAsB,EAAEtH,qBAAOsH,sBAbO;AActCC,EAAAA,gBAAgB,EAAEvH,qBAAOuH,gBAda;AAetCC,EAAAA,YAAY,EAAExH,qBAAOwH,YAfiB;AAgBtCzC,EAAAA,cAhBsC;AAkBtC1C,EAAAA,2BAlBsC;AAmBtCY,EAAAA,2BAnBsC;AAoBtCF,EAAAA,oBApBsC;AAsBtCrD,EAAAA,gBAtBsC;AAuBtCG,EAAAA,iBAvBsC;AAwBtCoF,EAAAA,gCAxBsC;AA0BtC;AACA/B,EAAAA,oBA3BsC;AA4BtCuD,EAAAA,uBA5BsC;AA6BtCvF,EAAAA,oBA7BsC;AA8BtCgD,EAAAA,0BA9BsC;AA+BtCwB,EAAAA,aA/BsC;AAiCtCnB,EAAAA,oBAjCsC;AAmCtC;AACAsB,EAAAA,kBApCsC;AAqCtCc,EAAAA,qBArCsC;AAsCtC7C,EAAAA,kBAtCsC;AAuCtC8C,EAAAA,iBAvCsC;AAyCtC;AACArF,EAAAA,kBA1CsC;AA4CtC;AACA4B,EAAAA,2BA7CsC;AA+CtCM,EAAAA,2BA/CsC;AAgDtClB,EAAAA,oBAhDsC;AAkDtCgB,EAAAA;AAlDsC,CAAxC;eAwDewD,S","sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport Native, {\n  EventEmitter,\n  HKCategorySampleRaw,\n  HKCategoryTypeIdentifier,\n  HKCategoryValueForIdentifier,\n  HKCharacteristicTypeIdentifier,\n  HKCorrelationRaw,\n  HKCorrelationTypeIdentifier,\n  HKQuantitySampleRaw,\n  HKQuantityTypeIdentifier,\n  HKSampleTypeIdentifier,\n  HKUnit,\n  HKUnitSI,\n  HKUnitSIPrefix,\n  HKWorkoutRaw,\n  MetadataMapperForCategoryIdentifier,\n} from './native-types';\nimport type {\n  GenericQueryOptions,\n  GetMostRecentCategorySampleFn,\n  GetMostRecentQuantitySampleFn,\n  GetMostRecentWorkoutFn,\n  GetPreferredUnitFn,\n  GetPreferredUnitsFn,\n  HKCategorySample,\n  HKCorrelation,\n  HKQuantitySample,\n  HKWorkout,\n  QueryCategorySamplesFn,\n  QueryCorrelationSamplesFn,\n  QueryQuantitySamplesFn,\n  QueryStatisticsForQuantityFn,\n  QueryWorkoutsFn,\n  ReactNativeHealthkit,\n  SaveCorrelationSampleFn,\n  SaveQuantitySampleFn,\n  SaveWorkoutSampleFn,\n  SubscribeToChangesFn,\n} from './types';\n\nconst getPreferredUnit: GetPreferredUnitFn = async (type) => {\n  const [unit] = await getPreferredUnits([type]);\n  return unit;\n};\n\nconst ensureUnit = async <TUnit extends HKUnit>(\n  type: HKQuantityTypeIdentifier,\n  providedUnit?: TUnit\n) => {\n  if (providedUnit) {\n    return providedUnit;\n  }\n  const unit = await Native.getPreferredUnits([type]);\n  return unit[type] as TUnit;\n};\n\nfunction deserializeSample<\n  TIdentifier extends HKQuantityTypeIdentifier,\n  TUnit extends HKUnit\n>(\n  sample: HKQuantitySampleRaw<TIdentifier, TUnit>\n): HKQuantitySample<TIdentifier, TUnit> {\n  return {\n    ...sample,\n    startDate: new Date(sample.startDate),\n    endDate: new Date(sample.endDate),\n  };\n}\n\nfunction deserializeWorkout<TEnergy extends HKUnit, TDistance extends HKUnit>(\n  sample: HKWorkoutRaw<TEnergy, TDistance>\n): HKWorkout<TEnergy, TDistance> {\n  return {\n    ...sample,\n    startDate: new Date(sample.startDate),\n    endDate: new Date(sample.endDate),\n  };\n}\n\nconst deserializCategorySample = <T extends HKCategoryTypeIdentifier>(\n  sample: HKCategorySampleRaw<T>\n): HKCategorySample<T> => {\n  return {\n    ...sample,\n    startDate: new Date(sample.startDate),\n    endDate: new Date(sample.endDate),\n  };\n};\n\nconst serializeDate = (date?: Date | null): string => {\n  return date ? date.toISOString() : new Date(0).toISOString();\n};\n\nconst prepareOptions = (options: GenericQueryOptions) => {\n  const limit =\n    !options.limit || options.limit === Infinity ? 0 : options.limit;\n  const ascending = options.ascending ?? limit === 0;\n  const from = serializeDate(options.from);\n  const to = serializeDate(options.to);\n  return { limit, ascending, from, to };\n};\n\nconst queryQuantitySamples: QueryQuantitySamplesFn = async (\n  identifier,\n  options\n) => {\n  const unit = await ensureUnit(identifier, options.unit);\n  const opts = prepareOptions(options);\n\n  const quantitySamples = await Native.queryQuantitySamples(\n    identifier,\n    unit,\n    opts.from,\n    opts.to,\n    opts.limit,\n    opts.ascending\n  );\n\n  return quantitySamples.map(deserializeSample);\n};\n\nconst subscribeToChanges: SubscribeToChangesFn = async (\n  identifier,\n  callback\n) => {\n  const subscription = EventEmitter.addListener(\n    'onChange',\n    ({ typeIdentifier }) => {\n      if (typeIdentifier === identifier) {\n        callback();\n      }\n    }\n  );\n\n  const queryId = await Native.subscribeToObserverQuery(identifier).catch(\n    (error) => {\n      subscription.remove();\n      return Promise.reject(error);\n    }\n  );\n\n  return () => {\n    subscription.remove();\n    return Native.unsubscribeQuery(queryId);\n  };\n};\n\nconst getMostRecentQuantitySample: GetMostRecentQuantitySampleFn = async (\n  identifier,\n  unit\n) => {\n  const samples = await queryQuantitySamples(identifier, {\n    limit: 1,\n    unit: unit,\n  });\n  return samples[0];\n};\n\nfunction useMostRecentWorkout<\n  TEnergy extends HKUnit,\n  TDistance extends HKUnit\n>(options?: { energyUnit?: TEnergy; distanceUnit?: TDistance }) {\n  const [workout, setWorkout] = useState<HKWorkout<TEnergy, TDistance> | null>(\n    null\n  );\n  useEffect(() => {\n    let cancelSubscription: (() => Promise<boolean>) | undefined;\n\n    const init = async () => {\n      const { energyUnit, distanceUnit } = await getPreferredUnitsTyped(\n        options\n      );\n\n      cancelSubscription = await subscribeToChanges(\n        'HKWorkoutTypeIdentifier',\n        () => {\n          getMostRecentWorkout({ energyUnit, distanceUnit }).then(setWorkout);\n        }\n      );\n    };\n    init();\n    return () => {\n      cancelSubscription && cancelSubscription();\n    };\n  }, [options]);\n  return workout;\n}\n\nconst getMostRecentCategorySample: GetMostRecentCategorySampleFn = async (\n  identifier\n) => {\n  const samples = await queryCategorySamples(identifier, {\n    limit: 1,\n    ascending: false,\n  });\n\n  return samples[0];\n};\n\nfunction useMostRecentCategorySample<\n  TCategory extends HKCategoryTypeIdentifier\n>(identifier: TCategory) {\n  const [category, setCategory] = useState<HKCategorySample<TCategory> | null>(\n    null\n  );\n  const updater = useCallback(() => {\n    getMostRecentCategorySample(identifier).then(setCategory);\n  }, [identifier]);\n\n  useSubscribeToChanges(identifier, updater);\n\n  return category;\n}\n\nfunction useSubscribeToChanges<TIdentifier extends HKSampleTypeIdentifier>(\n  identifier: TIdentifier,\n  onChange: () => void\n): void {\n  useEffect(() => {\n    let cancelSubscription: (() => Promise<boolean>) | undefined;\n\n    const init = async () => {\n      cancelSubscription = await subscribeToChanges(identifier, onChange);\n    };\n    init();\n\n    return () => {\n      cancelSubscription && cancelSubscription();\n    };\n  }, [identifier, onChange]);\n}\n\nfunction useMostRecentQuantitySample<\n  TIdentifier extends HKQuantityTypeIdentifier,\n  TUnit extends HKUnit = HKUnit\n>(identifier: TIdentifier, unit?: TUnit) {\n  const [lastSample, setLastSample] = useState<HKQuantitySample<\n    TIdentifier,\n    TUnit\n  > | null>(null);\n\n  useEffect(() => {\n    let cancelSubscription: (() => Promise<boolean>) | undefined;\n\n    const init = async () => {\n      const actualUnit = await ensureUnit(identifier, unit);\n\n      cancelSubscription = await subscribeToChanges(identifier, () => {\n        getMostRecentQuantitySample(identifier, actualUnit).then((value) => {\n          setLastSample(value);\n        });\n      });\n    };\n    init();\n\n    return () => {\n      cancelSubscription && cancelSubscription();\n    };\n  }, [identifier, unit]);\n\n  return lastSample;\n}\n\nconst saveQuantitySample: SaveQuantitySampleFn = (\n  identifier,\n  unit,\n  value,\n  options\n) => {\n  const start = options?.start || options?.end || new Date();\n  const end = options?.end || options?.start || new Date();\n  const metadata = options?.metadata || {};\n\n  return Native.saveQuantitySample(\n    identifier,\n    unit,\n    value,\n    start.toISOString(),\n    end.toISOString(),\n    metadata\n  );\n};\n\nconst queryStatisticsForQuantity: QueryStatisticsForQuantityFn = async (\n  identifier,\n  options,\n  from,\n  to,\n  unit\n) => {\n  const actualUnit = await ensureUnit(identifier, unit);\n  const toDate = to || new Date();\n  const {\n    mostRecentQuantityDateInterval,\n    ...rawResponse\n  } = await Native.queryStatisticsForQuantity(\n    identifier,\n    actualUnit,\n    from.toISOString(),\n    toDate.toISOString(),\n    options\n  );\n\n  const response = {\n    ...rawResponse,\n    ...(mostRecentQuantityDateInterval\n      ? {\n          mostRecentQuantityDateInterval: {\n            from: new Date(mostRecentQuantityDateInterval.from),\n            to: new Date(mostRecentQuantityDateInterval.to),\n          },\n        }\n      : {}),\n  };\n\n  return response;\n};\n\nconst requestAuthorization = (\n  read: (HKCharacteristicTypeIdentifier | HKSampleTypeIdentifier)[],\n  write: HKSampleTypeIdentifier[] = []\n): Promise<boolean> => {\n  const readPermissions = read.reduce((obj, cur) => {\n    return { ...obj, [cur]: true };\n  }, {});\n\n  const writePermissions = write.reduce((obj, cur) => {\n    return { ...obj, [cur]: true };\n  }, {});\n\n  return Native.requestAuthorization(writePermissions, readPermissions);\n};\n\nconst getDateOfBirth = async () => {\n  const dateOfBirth = await Native.getDateOfBirth();\n  return new Date(dateOfBirth);\n};\n\nconst getRequestStatusForAuthorization = (\n  read: (HKCharacteristicTypeIdentifier | HKSampleTypeIdentifier)[],\n  write: HKSampleTypeIdentifier[] = []\n) => {\n  const readPermissions = read.reduce((obj, cur) => {\n    return { ...obj, [cur]: true };\n  }, {});\n\n  const writePermissions = write.reduce((obj, cur) => {\n    return { ...obj, [cur]: true };\n  }, {});\n\n  return Native.getRequestStatusForAuthorization(\n    writePermissions,\n    readPermissions\n  );\n};\n\nconst queryCategorySamples: QueryCategorySamplesFn = async (\n  identifier,\n  options\n) => {\n  const opts = prepareOptions(options);\n  const results = await Native.queryCategorySamples(\n    identifier,\n    opts.from,\n    opts.to,\n    opts.limit,\n    opts.ascending\n  );\n\n  return results.map(deserializCategorySample);\n};\n\nasync function getPreferredUnitsTyped<\n  TEnergy extends HKUnit,\n  TDistance extends HKUnit\n>(options?: { energyUnit?: TEnergy; distanceUnit?: TDistance }) {\n  let energyUnit = options?.energyUnit;\n  let distanceUnit = options?.distanceUnit;\n  if (!energyUnit || !distanceUnit) {\n    const units = await Native.getPreferredUnits([\n      HKQuantityTypeIdentifier.distanceWalkingRunning,\n      HKQuantityTypeIdentifier.activeEnergyBurned,\n    ]);\n    if (!energyUnit) {\n      energyUnit = units[HKQuantityTypeIdentifier.distanceWalkingRunning] as\n        | TEnergy\n        | undefined;\n    }\n    if (!distanceUnit) {\n      distanceUnit = units[HKQuantityTypeIdentifier.activeEnergyBurned] as\n        | TDistance\n        | undefined;\n    }\n  }\n  if (!energyUnit) {\n    energyUnit = HKUnit.Kilocalories as TEnergy;\n  }\n  if (!distanceUnit) {\n    distanceUnit = HKUnit.Meters as TDistance;\n  }\n  return { energyUnit, distanceUnit };\n}\n\nconst queryWorkouts: QueryWorkoutsFn = async (options) => {\n  const { energyUnit, distanceUnit } = await getPreferredUnitsTyped(options);\n  const opts = prepareOptions(options);\n\n  const workouts = await Native.queryWorkoutSamples(\n    energyUnit,\n    distanceUnit,\n    opts.from,\n    opts.to,\n    opts.limit,\n    opts.ascending\n  );\n\n  return workouts.map(deserializeWorkout);\n};\n\nconst getMostRecentWorkout: GetMostRecentWorkoutFn = async (options) => {\n  const workouts = await queryWorkouts({\n    limit: 1,\n    ascending: false,\n    energyUnit: options?.energyUnit,\n    distanceUnit: options?.distanceUnit,\n  });\n\n  return workouts[0];\n};\n\nfunction saveCategorySample<T extends HKCategoryTypeIdentifier>(\n  identifier: T,\n  value: HKCategoryValueForIdentifier<T>,\n  options?: {\n    start?: Date;\n    end?: Date;\n    metadata?: MetadataMapperForCategoryIdentifier<T>;\n  }\n) {\n  const start = options?.start || options?.end || new Date();\n  const end = options?.end || options?.start || new Date();\n  const metadata = options?.metadata || {};\n\n  return Native.saveCategorySample(\n    identifier,\n    value,\n    start.toISOString(),\n    end.toISOString(),\n    metadata || {}\n  );\n}\n\nconst getPreferredUnits: GetPreferredUnitsFn = async (identifiers) => {\n  const units = await Native.getPreferredUnits(identifiers);\n  return identifiers.map((i) => units[i]);\n};\n\nconst buildUnitWithPrefix = (prefix: HKUnitSIPrefix, unit: HKUnitSI) => {\n  return `${prefix}${unit}` as HKUnit;\n};\n\nfunction deserializeCorrelation<\n  TIdentifier extends HKCorrelationTypeIdentifier\n>(s: HKCorrelationRaw<TIdentifier>): HKCorrelation<TIdentifier> {\n  return {\n    ...s,\n    objects: s.objects.map((o) => {\n      // @ts-ignore\n      if (o.quantity !== undefined) {\n        return deserializeSample(o as HKQuantitySampleRaw);\n      }\n\n      return deserializCategorySample(o as HKCategorySampleRaw);\n    }),\n    endDate: new Date(s.endDate),\n    startDate: new Date(s.startDate),\n  };\n}\n\nfunction ensureMetadata<TMetadata>(metadata?: TMetadata) {\n  return metadata || ({} as TMetadata);\n}\n\nconst queryCorrelationSamples: QueryCorrelationSamplesFn = async (\n  typeIdentifier,\n  options\n) => {\n  const opts = prepareOptions(options);\n  const correlations = await Native.queryCorrelationSamples(\n    typeIdentifier,\n    opts.from,\n    opts.to\n  );\n\n  return correlations.map(deserializeCorrelation);\n};\n\nconst saveCorrelationSample: SaveCorrelationSampleFn = async (\n  typeIdentifier,\n  samples,\n  options\n) => {\n  const start = (options?.start || new Date()).toISOString();\n  const end = (options?.end || new Date()).toISOString();\n\n  return Native.saveCorrelationSample(\n    typeIdentifier,\n    samples,\n    start,\n    end,\n    ensureMetadata(options?.metadata)\n  );\n};\n\nconst saveWorkoutSample: SaveWorkoutSampleFn = (\n  typeIdentifier,\n  quantities,\n  _start,\n  options\n) => {\n  const start = _start.toISOString();\n  const end = (options?.end || new Date()).toISOString();\n\n  return Native.saveWorkoutSample(\n    typeIdentifier,\n    quantities,\n    start,\n    end,\n    ensureMetadata(options?.metadata)\n  );\n};\n\nconst Healthkit: ReactNativeHealthkit = {\n  authorizationStatusFor: Native.authorizationStatusFor,\n\n  isHealthDataAvailable: Native.isHealthDataAvailable,\n\n  buildUnitWithPrefix,\n\n  disableAllBackgroundDelivery: Native.disableAllBackgroundDelivery,\n  disableBackgroundDelivery: Native.disableBackgroundDelivery,\n  enableBackgroundDelivery: Native.enableBackgroundDelivery,\n\n  // simple convenience getters\n  getBiologicalSex: Native.getBiologicalSex,\n  getFitzpatrickSkinType: Native.getFitzpatrickSkinType,\n  getWheelchairUse: Native.getWheelchairUse,\n  getBloodType: Native.getBloodType,\n  getDateOfBirth,\n\n  getMostRecentQuantitySample,\n  getMostRecentCategorySample,\n  getMostRecentWorkout,\n\n  getPreferredUnit,\n  getPreferredUnits,\n  getRequestStatusForAuthorization,\n\n  // query methods\n  queryCategorySamples,\n  queryCorrelationSamples,\n  queryQuantitySamples,\n  queryStatisticsForQuantity,\n  queryWorkouts,\n\n  requestAuthorization,\n\n  // save methods\n  saveCategorySample,\n  saveCorrelationSample,\n  saveQuantitySample,\n  saveWorkoutSample,\n\n  // subscriptions\n  subscribeToChanges,\n\n  // hooks\n  useMostRecentCategorySample,\n\n  useMostRecentQuantitySample,\n  useMostRecentWorkout,\n\n  useSubscribeToChanges,\n};\n\nexport * from './types';\nexport * from './native-types';\n\nexport default Healthkit;\n"]}